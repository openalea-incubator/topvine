from numpy import expdef Jarvis_gs(PPFD, hs, Tac, psi, gsmax = 0.330,  K1= 133, K2 = 0.26 , K3 = 0.004, K4 = 1.85 , psi0 = 0.37 , To = 30):    '''    compute stomatal conductance = f( PAR, VPD, Tac, psi) after Winckel & Rambal (1990), Jarvis model    PPFD : Photosynthetic Photon Flux Density (micromol m2 s-1)    Tac : air temperature (degres celsius)    hs : relative humidity (pourcent)    psi : predawn leaf water potential (-MPa)    gsmax : maximal stomatal conductance (mol m2 s-1)    K1 : parameter for PPFD response(micromol m2 s-1)    K2 : parameter for VPD response(kPa-1)    K3 : parameter for Tac response (degres C-2)    To : optimal temperature for stomatal openning    K4 : parameter for psi response (#)    Psio : value require to reduce maximum gs by half (-MPa)    '''        es_a = 0.611*exp(17.27*Tac/(237.3+Tac)) # saturated vapor pressure in the ambiant air (kPa)    ea=es_a*hs/100 # actual vapor pressure at air temperature (kPa)    D = es_a - ea # vapor pressure deficit at air temperature (kPa)    g_PPFD = 1.-exp(-PPFD/K1) #PPFD response (micromol photon m2 s-1)    #g_D = 1-(K2*D) #VPD response(kPa-1) linear; JPrieto, 17-3-2011    if D <1.8:        g_D=1    else:        g_D= 1.1645* exp (-K2*D)    #g_D = exp(-K2*D) #VPD response(kPa-1)    if ((Tac-To)**2)<1./K3: # Tac response (degres C)       g_Tac=1.-K3*(Tac-To)**2.    else:       g_Tac=0.           g_psi = 1./(1.+(psi/psi0)**K4) # psi response (Mpa)    gs=gsmax*g_PPFD*g_D*g_Tac*g_psi # (stomatal conductance mol m2 s-1)    return gs